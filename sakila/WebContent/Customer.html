<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>sakila customer Insert</title>
<!-- 스타일시트 css 파일 import -->
<style>
	body {
		padding: 0;
		margin: 0;
		width: 100%;
		height: 100%;
		overflow: hidden;
		background-position: 0 0;
		background-repeat: no-repeat;
		background-attachment: fixed;
		background-size: cover;
		position: relative;
		overflow-y: auto;
	}
	
	#aside {
		width: 200px;
		height: 3000px;
		position: fixed;
		background: orange;
		overflow: hidden;
		float: left;
	}
	
	#section {
		margin-left: 300px;
		margin-right: 500px;
		margin-bottom: 100px;
		background: white;
	}
</style>
</head>
<body>
	<!-- 메뉴-->
	<div id="aside">
			<!-- aside.html을 include -->
	</div>
   <!-- 내용 -->
   <div id="section">
      <h1>고객</h1>
      <hr>
      <!-- 도시 추가 -->
      <table>
         <tr>
            <td>
               <!-- 국가 선택 -->
               <div>
                  <select size="10" id="countryList">
                  </select>
               <!-- selecting city -->
                  <select size="10" id="cityList">
                  </select>
               </div>               
            </td>       
      	</tr>
      </table>
	  <form>
         	<fieldset>
                <legend>주소정보</legend>
                   <hr>
                   city_id: <input type="text" id="cityId" readonly><hr>
                   address: <input type="text" id="address" ><hr>
                   address2: <input type="text" id="address2" ><hr>
                   district: <input type="text" id="district" ><hr>
                   postal_code: <input type="text" id="postalCode" ><hr>
                   phone: <input type="text" id="phone" ><hr>
             </fieldset>
             
             <fieldset>
                <legend>고객정보</legend>
                <div>storeId :
                   <select id="storeId">
                      <option value="1">1</option>
                      <option value="2">2</option>
                   </select>
                </div>
                <div>firstName : <input type="text" id="firstName"></div>
                <div>lastName : <input type="text" id="lastName"></div>
                <div>emailName : <input type="text" id="emailName"></div>
             </fieldset>
         <button type="button" id="addCustomer">고객추가</button>
	</form>   
</body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script>$("#aside").load("/sakila/aside.html");</script>
<script>
	$.ajax({
		url : "/sakila/address/selectCountryListAll",
		method : "POST",
		success : function(json){
			$("#countryList").empty(); //countryList 초기화
			$(json).each(function(index, item){ //each 반복문  <--json 만큼 반복
				temp ="<option value='";
				temp += item.countryId;
				temp += "'>";
				temp += item.country;
				temp += "</option>";
				$("#countryList").append(temp);
			});
		}
	});
	// 나라 선택시 나라 번호 출력 / city list select
	$("#countryList").change(function(){
	   $("#countryId").val($("#countryList").val());   // countryId값이 있을 장소에 countryList의 값을 넣는다.
	   $("#cityList").empty();
	   // when country selected -> 도시 목록 출력
	   $.ajax({
	      url:"/sakila/address/selectCityListByCountry", 
	      method: "POST",
	      data : {"countryId" : $("#countryList").val()},
	      success : function(json){
	         $(json).each(function(index, item){
	            temp="<option value='";
	            temp+=item.cityId;
	            temp+="'>";
	            temp+=item.city;
	            temp+="</option>";
	            $("#cityList").append(temp);
        	 });
     	 }
   	});
});
	$("#cityList").change(function(){
		 $("#cityId").val($("#cityList").val());
	});

	$("#addCustomer").click(function(){
		$.ajax({
			url : "/sakila/customer/insertCustomer",
			method : "POST",
			data : {"cityId" : $("#cityId").val(),
				"address": $("#address").val(),
				"address2": $("#address2").val(),
				"district": $("#district").val(),
				"postalCode": $("#postalCode").val(),
				"phone": $("#phone").val(),
				"storeId": $("#storeId").val(),
				"firstName": $("#firstName").val(),
				"lastName": $("#lastName").val(),
				"emailName": $("#emailName").val(),
				},
				success : function(){
					console.log("success!");
			}
			
		})
	})
</script>
</html>